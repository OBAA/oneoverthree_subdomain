{% extends 'accounts/base-auth.html' %}
{% load static %}

{% block content %}

<form class="login100-form validate-form" method='POST'>
    {% csrf_token %}
    <span class="login100-form-title p-b-34">
        Account Register
    </span>

    <p>{{ form.non_field_errors.as_text }}</p>

    {% for hidden_field in form.hidden_fields %}
    {{ hidden_field.errors }}
    {{ hidden_field }}
    {% endfor %}


    <div class="col-10 size13 bo4 m-b-12 mx-auto">
        <input class="sizefull s-text7 p-l-15 p-r-15" type="email" name="email" placeholder=" Email" maxlength="120" required="" id="id_email">
    </div>

    <div class="col-10 size13 bo4 m-b-12 mx-auto">
        <input class="sizefull s-text7 p-l-15 p-r-15" type="text" name="full_name" placeholder=" Full name" maxlength="120" id="id_full_name">
    </div>

    <div class="col-10 size13 bo4 m-b-12 mx-auto">
        <input class="sizefull s-text7 p-l-15 p-r-15" type="password" name="password1" placeholder=" Password" required="" id="id_password1">
    </div>

    <div class="col-10 size13 bo4 m-b-25 mx-auto">
        <input class="sizefull s-text7 p-l-15 p-r-15" type="password" name="password2" placeholder=" Confirm password" required="" id="id_password2">
    </div>

    <!--<div class="card col-10 m-b-25 mx-auto">-->
        <!--<div class="px-2 my-2">-->
            <!--<span class="s-text8 p-t-5 p-b-5">{{ form.image.errors }}</span>-->
            <!--<div class="row">-->
                <!--<div class="col-12 col-sm-4 col-md-12">-->
                    <!--<span class="s-text7"><p>Profile Image: </p></span>-->
                <!--</div>-->
                <!--<div class="col-12 col-sm-8 col-md-12">-->
                    <!--<div class="s-text11">{{ form.image }}</div>-->
                <!--</div>-->
            <!--</div>-->
            <!--<span class="s-text8 p-t-5 p-b-5">{{ form.image.help_text }}</span>-->
        <!--</div>-->
        <!--{{ form.x_0 }}-->
        <!--{{ form.y_0 }}-->
        <!--{{ form.height_0 }}-->
        <!--{{ form.width_0 }}-->
    <!--</div>-->

    <div class="container-login100-form-btn">
        <div class="size14 trans-0-4 m-b-10">
            <!-- Button -->
            <button class="flex-c-m sizefull bg1 bo-rad-23 hov1 s-text1 trans-0-4">
                Sign up
            </button>
        </div>
    </div>


    <div class="w-full text-center p-t-27 p-b-239">
        <!--<a href="{% url 'store_register' %}" class="txt2">-->
            <!--Apply for a Store?-->
        <!--</a>-->
        <span class="txt1">
            Apply for a Store?
        </span>

        <a href="{% url 'contact' %}" class="txt2">
            Send us a message!
        </a>
    </div>

    <div class="w-full text-center">
        <a href="{% url 'login' %}" class="txt3">
            Sign in
        </a>
    </div>
</form>


<!-- MODAL TO CROP THE IMAGE -->
<div class="modal fade" id="modalCrop" style="height: 100%;">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title">Crop image</h4>
            </div>
            <div class="modal-body">
                <img src="" id="image" style="max-width: 100%;">
            </div>
            <div class="modal-footer">
                <div class="btn-group pull-left" role="group">
                    <button type="button" class="btn btn-default js-zoom-in">
                        <span class="glyphicon glyphicon-zoom-in"></span>
                    </button>
                    <button type="button" class="btn btn-default js-zoom-out">
                        <span class="glyphicon glyphicon-zoom-out"></span>
                    </button>
                </div>
                <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                <button type="button" id="js-crop" class="btn btn-primary">Crop</button>
            </div>
        </div>
    </div>
</div>

{% endblock %}




{% block js %}
<!--Crop Product Image-->
<script>
    $(function () {
        /* SCRIPT TO OPEN THE MODAL WITH THE PREVIEW */

        // Opens modal for User profile image
        $(document).on('change','#id_image', function() {
            if (this.files && this.files[0]) {
                var reader = new FileReader();
                reader.onload = function (e) {
                    $("#image").attr("src", e.target.result);
                    $("#js-crop").attr("class", "btn btn-primary js-crop-image-a");
                    $("#modalCrop").modal("show");

                };
                reader.readAsDataURL(this.files[0]);
            }
        });


        /* SCRIPTS TO HANDLE THE CROPPER BOX */
        var $image = $("#image");
        var cropBoxData;
        var canvasData;

        // Loads cropper box for User profile image
        $("#modalCrop").on("shown.bs.modal", function () {
            $image.cropper({
                viewMode: 1,
                aspectRatio: 1/1,
                minCropBoxWidth: 200,
                minCropBoxHeight: 200,
                ready: function () {
                    $image.cropper("setCanvasData", canvasData);
                    $image.cropper("setCropBoxData", cropBoxData);
                }
            });
        }).on("hidden.bs.modal", function () {
            cropBoxData = $image.cropper("getCropBoxData");
            canvasData = $image.cropper("getCanvasData");
            $image.cropper("destroy");
        });

        // Enable zoom in button
        $(".js-zoom-in").click(function () {
            $image.cropper("zoom", 0.1);
        });

        // Enable zoom out button
        $(".js-zoom-out").click(function () {
            $image.cropper("zoom", -0.1);
        });

        /* SCRIPT TO COLLECT THE DATA AND POST TO THE SERVER */
        // Crops User profile image
        $(document).on('click','.js-crop-image', function() {
            var cropData = $image.cropper("getData");
            $("#id_x").val(cropData["x"]);
            $("#id_y").val(cropData["y"]);
            $("#id_height").val(cropData["height"]);
            $("#id_width").val(cropData["width"]);

            console.log("0");
            console.log($(cropData));
            console.log($(cropData["x"]));
            console.log($(cropData["y"]));
            console.log($(cropData["height"]));
            console.log($(cropData["width"]));

            // $("#productFormUpload").submit();
            $("#modalCrop").modal("hide");
        });

    });
</script>

{% endblock %}