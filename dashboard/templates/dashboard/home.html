{% extends "accounts/home.html" %}
{% load static %}

{% block header %}
{{ form.tags.media.css }}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/select2-bootstrap-theme/0.1.0-beta.10/select2-bootstrap.css">
{% endblock %}


{% block panel %}
<div class="m-b-50" style="height: 100vh">
    <ul class="nav nav-pills" id="myTab" role="tablist">
        <li class="nav-item">
            <a class="nav-link active" id="statistics-tab" data-toggle="tab" href="#statistics" role="tab" aria-controls="statistics" aria-selected="true">Statistics</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="{% url 'account:dashboard:orders' %}" role="tab" aria-selected="false">Orders</a>
        </li>
        <li class="nav-item">
            <a class="nav-link"  href="{% url 'account:dashboard:products' %}" role="tab" aria-selected="false">Products</a>
        </li>
    </ul>
    <div class="tab-content" id="myTabContent">
        <!--Store Statistics-->
        <div class="tab-pane fade show active" id="statistics" role="tabpanel" aria-labelledby="statistics-tab">
            <div class="row">
                <div class="col-6 mt-4 mx-auto grid-margin stretch-card">
                    <div class="card card-statistics">
                        <div class="card-body">
                            <div class="clearfix">
                                <div class="float-left">
                                    <i class="mdi mdi-cube text-danger icon-lg"></i>
                                </div>
                                <div class="float-right">
                                    <p class="mb-0 text-right">Total Revenue</p>
                                    <div class="fluid-container">
                                        <h3 class="font-weight-medium text-right mb-0">₦{{ dashboard.total_revenue }}</h3>
                                    </div>
                                </div>
                            </div>
                            <p class="text-muted mt-3 mb-0">
                                <i class="mdi mdi-alert-octagon mr-1" aria-hidden="true"></i> 65% lower growth
                            </p>
                        </div>
                    </div>
                </div>
                <!--<div class="col-xl-3 col-lg-3 col-md-3 col-sm-6 grid-margin stretch-card">-->
                <div class="col-6 col-md-6 mt-4 mx-auto grid-margin stretch-card">
                    <div class="card card-statistics">
                        <div class="card-body">
                            <div class="clearfix">
                                <div class="float-left">
                                    <i class="mdi mdi-receipt text-warning icon-lg"></i>
                                </div>
                                <div class="float-right">
                                    <p class="mb-0 text-right">Orders</p>
                                    <div class="fluid-container">
                                        <h3 class="font-weight-medium text-right mb-0">{{ dashboard.orders }}</h3>
                                    </div>
                                </div>
                            </div>
                            <p class="text-muted mt-3 mb-0">
                                <i class="mdi mdi-bookmark-outline mr-1" aria-hidden="true"></i> Pending Orders
                            </p>
                        </div>
                    </div>
                </div>
                <!--<div class="col-xl-3 col-lg-3 col-md-3 col-sm-6 grid-margin stretch-card">-->
                <div class="col-6 col-md-6 mt-4 mx-auto grid-margin stretch-card">
                    <div class="card card-statistics">
                        <div class="card-body">
                            <div class="clearfix">
                                <div class="float-left">
                                    <i class="mdi mdi-poll-box text-success icon-lg"></i>
                                </div>
                                <div class="float-right">
                                    <p class="mb-0 text-right">Sales</p>
                                    <div class="fluid-container">
                                        <h3 class="font-weight-medium text-right mb-0">{{ dashboard.sales }}</h3>
                                    </div>
                                </div>
                            </div>
                            <p class="text-muted mt-3 mb-0">
                                <i class="mdi mdi-calendar mr-1" aria-hidden="true"></i> Weekly Sales
                            </p>
                        </div>
                    </div>
                </div>
                <!--<div class="col-xl-3 col-lg-3 col-md-3 col-sm-6 grid-margin stretch-card">-->
                <div class="col-6 col-md-6 mt-4 mx-auto grid-margin stretch-card">
                    <div class="card card-statistics">
                        <div class="card-body">
                            <div class="clearfix">
                                <div class="float-left">
                                    <i class="mdi mdi-poll-box text-success icon-lg"></i>
                                </div>
                                <div class="float-right">
                                    <p class="mb-0 text-right">Sales</p>
                                    <div class="fluid-container">
                                        <h3 class="font-weight-medium text-right mb-0">{{ dashboard.sales }}</h3>
                                    </div>
                                </div>
                            </div>
                            <p class="text-muted mt-3 mb-0">
                                <i class="mdi mdi-calendar mr-1" aria-hidden="true"></i> All Time Sales
                            </p>
                        </div>
                    </div>
                </div>



                <!--<div class="col-xl-3 col-lg-3 col-md-3 col-sm-6 grid-margin stretch-card">-->
                <div class="col-6 col-md-6 mt-4 mx-auto grid-margin stretch-card">
                    <div class="card card-statistics">
                        <div class="card-body">
                            <div class="clearfix">
                                <div class="float-left">
                                    <i class="mdi mdi-poll-box text-success icon-lg"></i>
                                </div>
                                <div class="float-right">
                                    <p class="mb-0 text-right">Featured</p>
                                    <div class="fluid-container">
                                        <h3 class="font-weight-medium text-right mb-0">{{ dashboard.sales }}</h3>
                                    </div>
                                </div>
                            </div>
                            <p class="text-muted mt-3 mb-0">
                                <i class="mdi mdi-calendar mr-1" aria-hidden="true"></i> Sponsored Products
                            </p>
                        </div>
                    </div>
                </div>
                <!--<div class="col-xl-3 col-lg-3 col-md-3 col-sm-6 grid-margin stretch-card">-->
                <div class="col-6 col-md-6 mt-4 mx-auto grid-margin stretch-card">
                    <div class="card card-statistics">
                        <div class="card-body">
                            <div class="clearfix">
                                <div class="float-left">
                                    <i class="mdi mdi-poll-box text-success icon-lg"></i>
                                </div>
                                <div class="float-right">
                                    <p class="mb-0 text-right">Sales</p>
                                    <div class="fluid-container">
                                        <h3 class="font-weight-medium text-right mb-0">{{ dashboard.sales }}</h3>
                                    </div>
                                </div>
                            </div>
                            <p class="text-muted mt-3 mb-0">
                                <i class="mdi mdi-calendar mr-1" aria-hidden="true"></i> All Time Sales
                            </p>
                        </div>
                    </div>
                </div>

            </div>
        </div>

        <!--Orders Tab-->


        <!--Product List Tab  bg5 m-b-50 p-t-45 p-b-45 -->

    </div>
</div>

<section class="Appearance bg5 p-t-45 p-b-45">
		<div class="container">
			<div class="sec-title p-b-52">
				<h3 class="m-text5 t-center">
					Store Appearance
				</h3>
			</div>

            <form method="POST" action="{% url 'account:dashboard:update-store-image' %}" enctype="multipart/form-data">
                {% csrf_token %}
                <div class="row">
                    <div class="col-sm-10 col-md-6 p-b-30 m-l-r-auto">
                        <!-- Block3 -->
                        <div class="block3">
                            <div class="block3-img dis-block hov-img-zoom">
                                {% if store.slider_image %}
                                <img src="{{ store.slider_image.url }}" alt="{% static 'imag/store-slider.jpg' %}">
                                {% else %}
                                <img src="{% static 'img/store-slider.jpg' %}" alt="STORE SLIDER">
                                {% endif %}
                            </div>

                            <div class="block3-txt p-t-14">
                                <h4 class="m-text11 p-b-7">
                                    Store Slider Image
                                </h4>

                                <div class="row">
                                    <span class="col-4 col-md-12 s-text6">Upload image</span>
                                    <div class="col-6 col-md-12 upload-btn-wrapper s-text7">
                                        <p class="upload">Upload a file</p>
                                        {{ store_slider_form.slider_image }}
                                    </div>
                                </div>

                                {{ store_slider_form.x_1 }}
                                {{ store_slider_form.y_1 }}
                                {{ store_slider_form.height_1 }}
                                {{ store_slider_form.width_1 }}

                                <p class="s-text8 p-t-16">
                                    <b>Note:</b> This only applies to featured stores.
                                </p>
                            </div>
                        </div>
                    </div>

                    <div class="col-sm-10 col-md-6 p-b-30 m-l-r-auto">
                        <!-- Block3 -->
                        <div class="block3">
                            <div class="block3-img dis-block hov-img-zoom">
                                {% if store.header_image %}
                                <img src="{{ store.header_image.url }}" alt="{% static 'images/store-header.jpg' %}">
                                {% else %}
                                <img src="{% static 'img/store-header.jpg' %}" alt="STORE HEADER">
                                {% endif %}
                            </div>

                            <div class="block3-txt p-t-14">
                                <h4 class="m-text11 p-b-7">
                                    Store Header Image
                                </h4>

                                <div class="row">
                                    <span class="col-4 col-md-12 s-text6">Upload image</span>
                                    <div class="col-6 col-md-12 upload-btn-wrapper s-text7">
                                        <p class="upload">Upload a file</p>
                                        {{ store_header_form.header_image }}
                                    </div>
                                </div>

                                {{ store_header_form.x_2 }}
                                {{ store_header_form.y_2 }}
                                {{ store_header_form.height_2 }}
                                {{ store_header_form.width_2 }}

                                <p class="s-text8 p-t-16">
                                    <b>Note:</b> This is to replace the store home header
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <!--Save image(s)-->
                <div class="col-12 m-t-12 m-b-10">
                    <div class="size10 trans-0-2 ">
                        <!-- Link -->
                        <button class="flex-c-m sizefull bg1 bo-rad-23 hov1 s-text1 trans-0-4" type="submit">
                            Save Changes
                        </button>
                    </div>
                </div>
            </form>
		</div>
	</section>

    <div class="size11 m-r-10 mb-5 mb-m-3 text-right m-t-50 ml-auto">
        <a href="{{ store.get_absolute_url }}" class="flex-c-m size2 bo-rad-23 s-text1 bgblack hov1 trans-0-4">
            Visit Storefront? <i class="fa fa-arrow-right ml-2"></i>
        </a>
    </div>
{% endblock %}



{% block flannel %}

    <!--All Orders-->
    <div class="col-12 col-md-10 m-t-85 m-b-200 mx-auto">

            <!--<div class="card mb-5">-->
                <!--<div class="card-header">-->
                    <!--<h5 class="m-text20 text-center"> All Orders </h5>-->
                <!--</div>-->
                <!--<div class="card-block p-0">-->
                        <!--<table class="table table-hover table-sm">-->
                        <!--<thead>-->
                        <!--<tr>-->
                            <!--<th scope="col">Product</th>-->
                            <!--<th scope="col">Order Id</th>-->
                            <!--<th scope="col">Size</th>-->
                            <!--<th scope="col">Quantity</th>-->
                            <!--<th scope="col">Status</th>-->
                            <!--&lt;!&ndash;<th scope="col">Total</th>&ndash;&gt;-->
                        <!--</tr>-->
                        <!--</thead>-->
                            <!--<tbody>-->

                            <!--{% for object in object_list %}-->

                            <!--<tr>-->
                                <!--<td>{{ object }}</td>-->
                                <!--<td>-->
                                    <!--{{ object.order.order_id }}-->
                                <!--</td>-->
                                <!--<td>{{ object.size }}</td>-->
                                <!--<td>{{ object.quantity }}</td>-->
                                <!--<td>-->
                                    <!--{% if object.status == "processing" %}-->
                                    <!--<span class="badge badge-info">{{ object.status }}</span>-->
                                    <!--{% elif object.status == "shipped" %}-->
                                    <!--<span class="badge badge-warning">{{ object.status }}</span>-->
                                    <!--{% elif object.status == "completed" %}-->
                                    <!--<span class="badge badge-success">{{ object.status }}</span>-->
                                    <!--{% elif object.status == "refunded" %}-->
                                    <!--<span class="badge badge-danger">{{ object.status }}</span>-->
                                    <!--{% else %}-->
                                    <!--<span class="badge badge-secondary">{{ object.status }}</span>-->
                                    <!--{% endif %}-->
                                <!--</td>-->
                                <!--&lt;!&ndash;<td>₦{{ object.total_price }}</td>&ndash;&gt;-->
                            <!--</tr>-->

                            <!--{% empty %}-->

                            <!--<tr>-->
                                <!--<th scope="row">1</th>-->
                                <!--<td colspan="3"><p class="lead">No completed orders.</p></td>-->
                            <!--</tr>-->
                            <!--{% endfor %}-->
                            <!--</tbody>-->
                        <!--</table>-->

                <!--</div>-->
                <!--<div class="card-footer p-0">-->
                    <!--&lt;!&ndash;<nav aria-label="...">&ndash;&gt;-->
                        <!--&lt;!&ndash;<ul class="pagination justify-content-end mt-3 mr-3">&ndash;&gt;-->
                            <!--&lt;!&ndash;<li class="page-item disabled">&ndash;&gt;-->
                                <!--&lt;!&ndash;<span class="page-link">Previous</span>&ndash;&gt;-->
                            <!--&lt;!&ndash;</li>&ndash;&gt;-->
                            <!--&lt;!&ndash;<li class="page-item"><a class="page-link" href="#">1</a></li>&ndash;&gt;-->
                            <!--&lt;!&ndash;<li class="page-item active">&ndash;&gt;-->
                            <!--&lt;!&ndash;<span class="page-link">2<span class="sr-only">(current)</span>&ndash;&gt;-->
                            <!--&lt;!&ndash;</span>&ndash;&gt;-->
                            <!--&lt;!&ndash;</li>&ndash;&gt;-->
                            <!--&lt;!&ndash;<li class="page-item"><a class="page-link" href="#">3</a></li>&ndash;&gt;-->
                            <!--&lt;!&ndash;<li class="page-item">&ndash;&gt;-->
                                <!--&lt;!&ndash;<a class="page-link" href="#">Next</a>&ndash;&gt;-->
                            <!--&lt;!&ndash;</li>&ndash;&gt;-->
                        <!--&lt;!&ndash;</ul>&ndash;&gt;-->
                    <!--&lt;!&ndash;</nav>&ndash;&gt;-->
                <!--</div>-->
            <!--</div>-->


    </div>

    <!-- MODAL TO CROP THE IMAGE -->
    <div class="modal fade" id="modalCrop" style="height: 100%;">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                    <h4 class="modal-title">Crop image</h4>
                </div>
                <div class="modal-body">
                    <img src="" id="image" style="max-width: 80%;">
                </div>
                <div class="modal-footer">
                    <div class="btn-group pull-left" role="group">
                        <button type="button" class="btn btn-default js-zoom-in">
                            <span class="glyphicon glyphicon-zoom-in"></span>
                        </button>
                        <button type="button" class="btn btn-default js-zoom-out">
                            <span class="glyphicon glyphicon-zoom-out"></span>
                        </button>
                    </div>
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                    <button type="button" id="js-crop" class="btn btn-primary">UPLOAD</button>
                </div>
            </div>
        </div>
    </div>

{% endblock %}




<!--Block JS-->
{% block js %}

<!--Crop Product Image-->
<script>
    $(function () {
        /* SCRIPT TO OPEN THE MODAL WITH THE PREVIEW */

        // Opens modal for store slider image
        $(document).on('change', '#id_slider_image', function () {
            if (this.files && this.files[0]) {
                var reader = new FileReader();
                reader.onload = function (e) {
                    $("#image").attr("src", e.target.result);
                    $("#js-crop").attr("class", "btn btn-primary js-crop-slider-image");
                    $("#modalCrop").modal("show");
                };
                reader.readAsDataURL(this.files[0]);
            }
        });

        // Opens modal for store header image
        $(document).on('change', '#id_header_image', function () {
            if (this.files && this.files[0]) {
                var reader = new FileReader();
                reader.onload = function (e) {
                    $("#image").attr("src", e.target.result);
                    $("#js-crop").attr("class", "btn btn-primary js-crop-header-image");
                    $("#modalCrop").modal("show");
                };
                reader.readAsDataURL(this.files[0]);
            }
        });


        /* SCRIPTS TO HANDLE THE CROPPER BOX */
        var $image = $("#image");
        var cropBoxData;
        var canvasData;
        $("#modalCrop").on("shown.bs.modal", function () {
            $("#modalCrop").on("shown.bs.modal", function () {
                // $image.cropper({
                //     viewMode: 1,
                //     aspectRatio: 2 / 1,
                //     minCropBoxWidth: 240,
                //     minCropBoxHeight: 120,
                //     ready: function () {
                //         $image.cropper("setCanvasData", canvasData);
                //         $image.cropper("setCropBoxData", cropBoxData);
                //     }
                // });
                if ($("#js-crop").attr("class") === "btn btn-primary js-crop-slider-image"){
                    $image.cropper({
                        viewMode: 1,
                        aspectRatio: 2/1,
                        minCropBoxWidth: 240,
                        minCropBoxHeight: 120,
                        ready: function () {
                            $image.cropper("setCanvasData", canvasData);
                            $image.cropper("setCropBoxData", cropBoxData);
                        }
                    });
                } else {
                    $image.cropper({
                        viewMode: 1,
                        aspectRatio: 2/1,
                        minCropBoxWidth: 240,
                        minCropBoxHeight: 120,
                        ready: function () {
                            $image.cropper("setCanvasData", canvasData);
                            $image.cropper("setCropBoxData", cropBoxData);
                        }
                    });
                }
            }).on("hidden.bs.modal", function () {
                cropBoxData = $image.cropper("getCropBoxData");
                canvasData = $image.cropper("getCanvasData");
                $image.cropper("destroy");
            });

            // Enable zoom in button
            $(".js-zoom-in").click(function () {
                $image.cropper("zoom", 0.1);
            });

            // Enable zoom out button
            $(".js-zoom-out").click(function () {
                $image.cropper("zoom", -0.1);
            });

            /* SCRIPT TO COLLECT THE DATA AND POST TO THE SERVER */

            // Crops image file A
            $(document).on('click', '.js-crop-slider-image', function () {
                var cropData = $image.cropper("getData");
                $("#id_x_1").val(cropData["x"]);
                $("#id_y_1").val(cropData["y"]);
                $("#id_height_1").val(cropData["height"]);
                $("#id_width_1").val(cropData["width"]);

                console.log("a");
                console.log($(cropData));
                console.log($(cropData["x"]));
                console.log($(cropData["y"]));
                console.log($(cropData["height"]));
                console.log($(cropData["width"]));

                $("#modalCrop").modal("hide");
            });

            // Crops image file B
            $(document).on('click', '.js-crop-header-image', function () {
                var cropData = $image.cropper("getData");
                $("#id_x_2").val(cropData["x"]);
                $("#id_y_2").val(cropData["y"]);
                $("#id_height_2").val(cropData["height"]);
                $("#id_width_2").val(cropData["width"]);

                console.log("b");
                console.log($(cropData));
                console.log($(cropData["x"]));
                console.log($(cropData["y"]));
                console.log($(cropData["height"]));
                console.log($(cropData["width"]));

                $("#modalCrop").modal("hide");
            });
        })
    });
</script>

{% endblock %}

